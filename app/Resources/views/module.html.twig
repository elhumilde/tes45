<div class="panel-body">
    <h3 class="title-hero">
        Liste Des Etapes Workflow Site contact
    </h3>
    <div class="example-box-wrapper">
        <div id="form-wizard-3" class="form-wizard">



{#
            <ul>



                {% for ent in entity.bncommande.produit.customer.carts|reverse %}


                {% for entit in entities %}
                    {% if ent.idEtapePrecedente== 0 and  entit.idEtape== 1 and entit.idUser == app.user.id  %}

                        <li class="">
                            <a href="#step-1" data-toggle="tab">
                                <label class="wizard-step">1</label>
                              <span class="wizard-description">


                                          {{ ent.titre }}



                                 <small> {{ ent.description }} </small>
                                          <p> Temps Prevu : <span class="text-success">{{ ent.tempsPrevu }}</span></p>


                              </span>
                            </a>
                        </li>
                        {% elseif ent.idEtapePrecedente== 0 and  entit.idEtape != 1  and entit.idUser != app.user.id   %}


                            <li class="">
                                <a href="#step-1" data-toggle="tab">
                                    <label class="wizard-step">1</label>
                            <span class="wizard-description">


                                  {{ ent.titre }}
                            <small>{{ ent.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ ent.tempsPrevu }}</span></p>
                             {% if entit.idLigneBc|production.utilisateur.fullname  %} <p> Affecté a <span class="text-danger">{{ entit.idLigneBc|production.utilisateur.fullname }}</span></p> {% endif %}

                            </span>
                                </a>
                            </li>
                    {% endif %}
                    {% if ent.idEtapePrecedente== 1 and  entit.idEtape== 2 %}
                        <li class="">
                            <a href="#step-2" data-toggle="tab">
                                <label class="wizard-step">2</label>
                      <span class="wizard-description">

                                  {{ ent.titre }}

                          <small>{{ ent.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ ent.tempsPrevu }}</span></p>

                      </span>
                            </a>
                        </li>
                    {% elseif ent.idEtapePrecedente== 1 and  entit.idEtape != 2 %}

                        <li class="">
                            <a href="#step-2" data-toggle="tab">
                                <label class="wizard-step">2</label>
                      <span class="wizard-description">

                                  {{ ent.titre }}

                          <small>{{ ent.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ ent.tempsPrevu }}</span></p>
                          {% if entit.idLigneBc|productiond.utilisateur.fullname  %} <p> Affecté a <span class="text-danger">{{ entit.idLigneBc|productiond.utilisateur.fullname }}</span></p> {% endif %}

                      </span>
                            </a>
                        </li>
                    {% endif %}

                    {% if ent.idEtapePrecedente== 2  and  entit.idEtape== 3  %}
                        <li class="">
                            <a href="#step-3" data-toggle="tab">
                                <label class="wizard-step">3</label>
                       <span class="wizard-description">

                                  {{ ent.titre }}

                           <small>{{ ent.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ ent.tempsPrevu }}</span></p>


                      </span>
                            </a>
                        </li>

                    {% elseif ent.idEtapePrecedente== 2  and  entit.idEtape != 3 %}

                        <li class="">
                            <a href="#step-3" data-toggle="tab">
                                <label class="wizard-step">3</label>
                       <span class="wizard-description">

                                  {{ ent.titre }}

                           <small>{{ ent.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ ent.tempsPrevu }}</span></p>
                           {% if entit.idLigneBc|productiont.utilisateur.fullname  %} <p> Affecté a <span class="text-danger">{{ entit.idLigneBc|productiont.utilisateur.fullname }}</span></p> {% endif %}


                      </span>
                            </a>
                        </li>

                    {% endif %}
                {% endfor %}


                {% endfor %}
            </ul>
#}



            <ul>






                    {% for entit in entities|reverse %}

                        {% if  entit.etape.idEtapePrecedente==0 and  entit.idEtape== 4 and entit.idUser == app.user.id  %}

                            <li class="">
                                <a href="#step-1" data-toggle="tab">
                                    <label class="wizard-step">1</label>
                              <span class="wizard-description">


                                          {{ entit.etape.titre }}



                                  <small> {{ entit.etape.description }} </small>
                                          <p> Temps Prevu : <span class="text-success">{{ entit.etape.tempsPrevu }}</span></p>


                              </span>
                                </a>
                            </li>
                        {% elseif entit.etape.idEtapePrecedente==0 and  entit.idEtape== 4 and entit.idUser != app.user.id %}

                            <li class="">
                                <a href="#step-1" data-toggle="tab">
                                    <label class="wizard-step">1</label>
                            <span class="wizard-description">


                                  {{ entit.etape.titre }}
                                <small>{{entit.etape.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ entit.etape.tempsPrevu }}</span></p>
                        {% if entit.utilisateur%}        {% if entit.utilisateur.fullname  %} <p> Affecté a <span class="text-danger">{{ entit.utilisateur.fullname }}</span></p> {% endif %}{% endif %}

                            </span>
                                </a>
                            </li>

                        {% endif %}
                        {% if  entit.etape.idEtapePrecedente==1 and  entit.idEtape== 5  and entit.idUser == app.user.id %}
                            <li class="">
                                <a href="#step-2" data-toggle="tab">
                                    <label class="wizard-step">2</label>
                      <span class="wizard-description">

                                  {{ entit.etape.titre }}

                          <small>{{ entit.etape.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ entit.etape.tempsPrevu }}</span></p>

                      </span>
                                </a>
                            </li>
                        {% elseif entit.etape.idEtapePrecedente==1 and entit.idEtape== 5  and entit.idUser != app.user.id  %}

                            <li class="">
                                <a href="#step-2" data-toggle="tab">
                                    <label class="wizard-step">2</label>
                      <span class="wizard-description">

                                  {{ entit.etape.titre }}

                          <small>{{ entit.etape.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ entit.etape.tempsPrevu }}</span></p>
                          {% if entit.idLigneBc|productiond.utilisateur.fullname  %} <p> Affecté a <span class="text-danger">{{ entit.idLigneBc|productiond.utilisateur.fullname }}</span></p> {% endif %}

                      </span>
                                </a>
                            </li>
                        {% endif %}

                        {% if entit.etape.idEtapePrecedente==2 and  entit.idEtape== 6   and entit.idUser == app.user.id %}
                            <li class="">
                                <a href="#step-3" data-toggle="tab">
                                    <label class="wizard-step">3</label>
                       <span class="wizard-description">

                                  {{ entit.etape.titre }}

                           <small>{{ entit.etape.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ entit.etape.tempsPrevu }}</span></p>


                      </span>
                                </a>
                            </li>

                        {% elseif  entit.etape.idEtapePrecedente==2 and  entit.idEtape== 6   and entit.idUser != app.user.id  %}

                            <li class="">
                                <a href="#step-3" data-toggle="tab">
                                    <label class="wizard-step">3</label>
                       <span class="wizard-description">

                                  {{ entit.etape.titre }}

                           <small>{{ entit.etape.description }}</small>
                                  <p>Temps Prevu : <span class="text-success">{{ entit.etape.tempsPrevu }}</span></p>
                           {% if entit.utilisateur %}     {% if entit.utilisateur.fullname  %} <p> Affecté a <span class="text-danger">{{ entit.utilisateur.fullname }}</span></p> {% endif %}{% endif %}


                      </span>
                                </a>
                            </li>

                        {% endif %}
                    {% endfor %}



            </ul>


            <div class="tab-content">
                {% for entit in entities|reverse %}
                {% if  entit.etape.idEtapePrecedente==0 and  entit.idEtape== 4 and entit.idUser == app.user.id  %}
                 <div class="tab-pane" id="step-1">
                    <div class="content-box">
                        <h3 class="content-box-header bg-default">
                            Etape 1
                        </h3>
                        <input id="id_etape_1" type="text" value="{{ entit.id }}"  style= "display: none;" >
                        <div class="content-box-wrapper">
                            <div class="row">
                                <div class="col-sm-4">
                                <button id="one" class="btn btn-alt btn-hover btn-success" {% if entit.exucEtape %} disabled="disabled" {% endif %}>
                                    <span>Démarrer</span>
                                    <i class="glyph-icon icon-arrow-right"></i>
                                    <div class="ripple-wrapper"></div>
                                </button>
                                  </div>
                                <div class="col-sm-4">
                                    <button id="onek" class="btn btn-alt btn-hover btn-yellow center-block" {% if entit.exucEtape %}{% if entit.exucEtape.dateFin %} disabled="disabled" {% endif %} {% else %} disabled="disabled" {% endif %}>


                                        {% if entit.exucEtape %}
                                            {% if entit.exucEtape.etat %}
                                                {% if entit.exucEtape.etat=="2" %}   <span>Reprendre</span> {% elseif entit.exucEtape.etat=="0" %} <span>Pause</span>{% elseif entit.exucEtape.etat=="1" %} <span>Pause</span> {% endif %}
                                            {% else %}<span>Pause</span> {% endif %}
                                        {% else %}<span>Pause</span>
                                        {% endif %}
                                        <i class="glyph-icon icon-arrow-right"></i>
                                        <div class="ripple-wrapper"></div>
                                    </button>
                                </div>
                                <input id="etat_1" type="text" {% if entit.exucEtape %}{% if entit.exucEtape.etat %} {% if entit.exucEtape.etat=="2" %}  value="2" {% else %} value="1" {% endif %}     {% else %} value="1" {% endif %}{% else %} value="1" {% endif %} style= "display: none;" >
                                <div class="col-sm-4">
                                <button id="onef" class="btn btn-alt btn-hover btn-primary "{% if entit.exucEtape %}{% if entit.exucEtape.dateFin %} disabled="disabled" {% endif %} {% else %} disabled="disabled" {% endif %}>
                                    <span>Cloturer</span>
                                    <i class="glyph-icon icon-arrow-right"></i>
                                    <div class="ripple-wrapper"></div>
                                </button>
                                </div>
                            </div>
                            <br/>
                            <br/>
                            <div class="row">
                                <div class=" col-md-6">
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">Commentaire</label>
                                        <div class="col-sm-6">
                                            <textarea id="one_text" name="" rows="3" class="form-control textarea-counter" {% if entit.exucEtape %} {% else %} readonly {% endif %} >{% if entit.exucEtape %} {{ entit.exucEtape.commentaire }} {% endif %}</textarea>
                                            <div class="character-remaining clear input-description">125 characters left</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                    </div>
                 </div>
                {% elseif  entit.etape.idEtapePrecedente==0 and  entit.idEtape== 4 and entit.idUser != app.user.id  %}

                {% endif %}

                {% if  entit.etape.idEtapePrecedente==1 and  entit.idEtape== 5 and entit.idUser == app.user.id  %}

                <div class="tab-pane" id="step-2">
                    <div class="content-box">
                        <h3 class="content-box-header bg-black">
                            Etape 2
                        </h3>
                        <input id="id_etape_2" type="text" value="{{ entit.id }}"  style= "display: none;" >
                        <div class="content-box-wrapper">
                            <div class="row">
                                <div class="col-sm-4">
                                <button id="second" class="btn btn-alt btn-hover btn-success" {% if entit.exucEtape %} disabled="disabled" {% endif %}>
                                    <span>Démarrer</span>
                                    <i class="glyph-icon icon-arrow-right"></i>
                                    <div class="ripple-wrapper"></div></button>
                                 </div>
                                <div class="col-sm-4">
                                    <button id="secondk" class="btn btn-alt btn-hover btn-yellow center-block" {% if entit.exucEtape %}{% if entit.exucEtape.dateFin %} disabled="disabled" {% endif %} {% else %} disabled="disabled" {% endif %}>

                                        {% if entit.exucEtape %}
                                            {% if entit.exucEtape.etat %}
                                                {% if entit.exucEtape.etat=="2" %}   <span>Reprendre</span> {% elseif entit.exucEtape.etat=="0" %} <span>Pause</span>{% elseif entit.exucEtape.etat=="1" %} <span>Pause</span> {% endif %}
                                            {% else %}<span>Pause</span> {% endif %}
                                        {% else %}<span>Pause</span>
                                        {% endif %}
                                        <i class="glyph-icon icon-arrow-right"></i>
                                        <div class="ripple-wrapper"></div>
                                    </button>
                                </div>
                                <input id="etat_2" type="text" {% if entit.exucEtape %}{% if entit.exucEtape.etat %} {% if entit.exucEtape.etat=="2" %}  value="2" {% else %} value="1" {% endif %}     {% else %} value="1" {% endif %} {% else %} value="1"{% endif %} style= "display: none;" >
                                <div class="col-sm-4">
                                <button id="secondf" class="btn btn-alt btn-hover btn-primary " {% if entit.exucEtape %}{% if entit.exucEtape.dateFin %} disabled="disabled" {% endif %} {% else %} disabled="disabled" {% endif %}>
                                    <span>Cloturer</span>
                                    <i class="glyph-icon icon-arrow-right"></i>
                                    <div class="ripple-wrapper"></div></button>
                                </div>

                            </div>
                            <br/>
                            <br/>
                            <div class="row">
                                <div class=" col-md-6">
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">Commentaire</label>
                                        <div class="col-sm-6">
                                            <textarea id ="second_text" name="" rows="3" class="form-control textarea-counter" {% if entit.exucEtape %} {% else %} readonly {% endif %}>{% if entit.exucEtape %} {{ entit.exucEtape.commentaire }} {% endif %}</textarea>
                                            <div class="character-remaining clear input-description">125 characters left</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% elseif  entit.etape.idEtapePrecedente==1 and  entit.idEtape== 5 and entit.idUser != app.user.id  %}

                {% endif %}
                {% if  entit.etape.idEtapePrecedente==2 and  entit.idEtape== 6 and entit.idUser == app.user.id  %}
                <div class="tab-pane" id="step-3">
                    <div class="content-box">
                        <h3 class="content-box-header bg-green">
                            Etape 3
                        </h3>
                        <input id="id_etape_3" type="text" value="{{ entit.id }}"  style= "display: none;">
                        <div class="content-box-wrapper">
                            <div class="row" >

                                <div class="col-sm-4">
                                <button  id="tree" class="btn btn-alt btn-hover btn-success" {% if entit.exucEtape %} disabled="disabled" {% endif %}>
                                    <span>Démarrer</span>
                                    <i class="glyph-icon icon-arrow-right"></i>
                                    <div class="ripple-wrapper"></div>
                                </button>
                                 </div>

                                <div class="col-sm-4">

                                    <button id="treek" class="btn btn-alt btn-hover btn-yellow center-block" {% if entit.exucEtape %}{% if entit.exucEtape.dateFin %} disabled="disabled" {% endif %} {% else %} disabled="disabled" {% endif %}>

                                        {% if entit.exucEtape %}
                                            {% if entit.exucEtape.etat %}
                                                {% if entit.exucEtape.etat=="2" %}   <span>Reprendre</span> {% elseif entit.exucEtape.etat=="0" %} <span>Pause</span>{% elseif entit.exucEtape.etat=="1" %} <span>Pause</span> {% endif %}
                                            {% else %}<span>Pause</span> {% endif %}
                                        {% else %}<span>Pause</span>
                                        {% endif %}
                                        <i class="glyph-icon icon-arrow-right"></i>
                                        <div class="ripple-wrapper"></div>
                                    </button>


                                </div>

                                <input id="etat_3" type="text" {% if entit.exucEtape %}{% if entit.exucEtape.etat %} {% if entit.exucEtape.etat=="2" %}  value="2" {% else %} value="1" {% endif %}     {% else %} value="1" {% endif %} {% else %} value="1"{% endif %} style= "display: none;" >

                                <div class="col-sm-4">
                                    <button id="treef" class="btn btn-alt btn-hover btn-primary" {% if entit.exucEtape %}{% if entit.exucEtape.dateFin %} disabled="disabled" {% endif %} {% else %} disabled="disabled" {% endif %}>
                                    <span>Cloturer</span>
                                    <i class="glyph-icon icon-arrow-right"></i>
                                    <div class="ripple-wrapper"></div>
                                    </button>
                                 </div>
                            </div>
                            <br/>
                            <br/>
                            <div class="row">
                                <div class=" col-md-6">
                                    <div class="form-group">
                                        <label class="col-sm-3 control-label">Commentaire</label>
                                        <div class="col-sm-6">
                                            <textarea id="tree_text" name="" rows="3" class="form-control textarea-counter" {% if entit.exucEtape %} {% else %} readonly {% endif %}> {% if entit.exucEtape %} {{ entit.exucEtape.commentaire }} {% endif %}</textarea>
                                            <div class="character-remaining clear input-description">125 characters left</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                {% elseif  entit.etape.idEtapePrecedente==2 and  entit.idEtape== 6 and entit.idUser != app.user.id  %}


                 {% endif %}


                {% endfor %}



            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {


        $("#second_text").blur( function(event) {
            var  $vb =$("#second_text").val();
            var  $vid =$("#id_etape_2").val();


            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} ,text : $vb};

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_form_text') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        var successMessage = response.nom ;



                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });



        $("#secondk").click( function(event) {

            $("#loading").show();
            event.preventDefault();

            var $this = $(this);
            var  $vid =$("#id_etape_2").val();
            var $etat =$("#etat_2").val();

            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}},etat : $etat };

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_detaill') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        $("#loading").hide();

                        var successMessage = response.nom ;

                      //  $("#secondf").attr("disabled","disabled");
                   //     alert(successMessage);

                        var $te=$('#secondk span').text();

                        if( $te=='Reprendre'){

                         $('#secondk span').text('Pause');
                            $("#etat_2").val(1);
                        }
                        else if($te=='Pause'){
                         $('#secondk span').text('Reprendre');
                            $("#etat_2").val(2);
                        }
                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });



        $("#secondf").click( function(event) {
            event.preventDefault();

            var $this = $(this);
            var  $vid =$("#id_etape_2").val();

            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} };

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_form_fin') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        var successMessage = response.nom ;

                        $("#secondf").attr("disabled","disabled");
                        alert(successMessage);
                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });



        $("#second").click( function(event) {
            event.preventDefault();

            var $this = $(this);
            var  $vid =$("#id_etape_2").val();

            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} };

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_form') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        var successMessage = response.nom ;

                        $("#second").attr("disabled","disabled");
                        $('#secondf').prop("disabled", false);
                        $('#second_text').prop("readonly", false);
                        $('#secondk').prop("disabled", false);


                      //  alert(successMessage);
                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });




        $("#one_text").blur( function(event) {
            var  $vb =$("#one_text").val();
            var  $vid =$("#id_etape_1").val();


            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} ,text : $vb};

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_form_text') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        var successMessage = response.nom ;



                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });


        $("#onek").click( function(event) {

            $("#loading").show();
            event.preventDefault();

            var $this = $(this);
            var  $vid =$("#id_etape_1").val();
            var $etat =$("#etat_1").val();

            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}},etat : $etat };

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_detaill') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        $("#loading").hide();

                        var successMessage = response.nom ;

                        //  $("#secondf").attr("disabled","disabled");
                        //     alert(successMessage);

                        var $te=$('#onek span').text();

                        if( $te=='Reprendre'){

                            $('#onek span').text('Pause');
                            $("#etat_1").val(1);
                        }
                        else if($te=='Pause'){
                            $('#onek span').text('Reprendre');
                            $("#etat_1").val(2);
                        }
                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });

        $("#one").click( function(event) {
            event.preventDefault();

            var $this = $(this);
            var  $vid =$("#id_etape_1").val();

            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} };

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_form') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        var successMessage = response.nom ;

                        $("#one").attr("disabled","disabled");
                        $('#onef').prop("disabled", false);
                        $('#one_text').prop("readonly", false);
                        $('#onek').prop("disabled", false);
                    //    alert(successMessage);
                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });


        $("#onef").click( function(event) {
            event.preventDefault();

            var $this = $(this);
            var  $vid =$("#id_etape_1").val();

            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} };

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_form_fin') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        var successMessage = response.nom ;

                        $("#onef").attr("disabled","disabled");
                        alert(successMessage);
                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });





        $("#tree_text").blur( function(event) {
           var  $vb =$("#tree_text").val();
            var  $vid =$("#id_etape_3").val();


            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} ,text : $vb};

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_form_text') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        var successMessage = response.nom ;



                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });


        $("#treek").click( function(event) {



            $("#loading").show();
            event.preventDefault();

            var $this = $(this);
            var  $vid =$("#id_etape_3").val();
            var $etat =$("#etat_3").val();

            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}},etat : $etat };

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_detaill') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        $("#loading").hide();

                        var successMessage = response.nom ;

                        //  $("#secondf").attr("disabled","disabled");
                        //     alert(successMessage);

                        var $te=$('#treek span').text();

                        if( $te=='Reprendre'){

                            $('#treek span').text('Pause');
                            $("#etat_3").val(1);
                        }
                        else if($te=='Pause'){

                            $('#treek span').text('Reprendre');
                            $("#etat_3").val(2);
                        }
                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });





        $("#treef").click( function(event) {
            event.preventDefault();

            var $this = $(this);
            var  $vid =$("#id_etape_3").val();

            var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} };

            //Ici on peut ajouter un loader...
            $.ajax({

                url: '{{ path('affectation_form_fin') }}',
                type: 'POST',
                data: data_send,

                statusCode: {
                    //traitement en cas de succès
                    200: function(response) {

                        var successMessage = response.nom ;

                        $("#treef").attr("disabled","disabled");
                        alert(successMessage);
                        // alert(successMessage+''+successM+''+successF+' c bien passée');
                        //on vide les champs formulaires ou on le supprime ou ...

                        //on retire le loader...
                        //on prévient l'utilistateur du bonne envoi...

                    },
                    //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                    412: function(response) {
                        var errorsForm = response.responseJSON.formErrors ;
                        //on affiche les erreurs...
                    }
                }
            });


        });

    $("#tree").click( function(event) {
        event.preventDefault();

        var $this = $(this);
        var  $vid =$("#id_etape_3").val();

        var data_send = { usern: 'fayssal', etape : $vid , 'idbc' : {{ idbc}} };

        //Ici on peut ajouter un loader...
        $.ajax({

            url: '{{ path('affectation_form') }}',
            type: 'POST',
            data: data_send,

            statusCode: {
                //traitement en cas de succès
                200: function(response) {

                    var successMessage = response.nom ;

                    $("#tree").attr("disabled","disabled");
                    $('#treef').prop("disabled", false);
                    $('#tree_text').prop("readonly", false);
                    $('#treek').prop("disabled", false);
                //    alert(successMessage);
                    // alert(successMessage+''+successM+''+successF+' c bien passée');
                    //on vide les champs formulaires ou on le supprime ou ...

                    //on retire le loader...
                    //on prévient l'utilistateur du bonne envoi...

                },
                //traitement en cas d'erreur (on peut aussi traiter le cas erreur 500...)
                412: function(response) {
                    var errorsForm = response.responseJSON.formErrors ;
                    //on affiche les erreurs...
                }
            }
        });


    });
        });
</script>

